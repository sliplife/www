webpackJsonp([5],{1340:function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(64),i=o.n(s),c=o(0),p=o.n(c),l=o(80),d=o(158),u=(o.n(d),o(81)),h=o(100),f=(o.n(h),o(150)),m=o(149),w=o(985);o.d(t,"default",function(){return k});var y,g,v,P,b=function(e){return{auth:e.auth,tokens:e.tokens}},E=function(e){return{dispatch:e,actions:{alert:o.i(f.bindActionCreators)(m.d,e),auth:o.i(f.bindActionCreators)(m.a,e),tokens:o.i(f.bindActionCreators)(m.g,e)}}},k=(y=o.i(l.connect)(b,E))((P=v=function(e){function t(o){n(this,t);var a=r(this,e.call(this,o));return a.state={isLoading:!1,email:"",password:"",verificationPassword:"",redirectTo:"/"},a.handleRecover=a.handleRecover.bind(a),a.updatePassword=a.updatePassword.bind(a),a.handleChange=a.handleChange.bind(a),a}return a(t,e),t.prototype.componentWillMount=function(){this.props.auth.user&&this.props.dispatch(o.i(d.push)(this.state.redirectTo))},t.prototype.componentDidMount=function(){this.props.routeParams.token?this.props.actions.tokens.read(this.props.routeParams.token,{with:"user"}).then(function(){return w.a.done()}):w.a.done()},t.prototype.hasValidationError=function(e){return!(!i()(this.props.auth.error,"validation.keys")||!this.props.auth.error.validation.keys.includes(e))},t.prototype.handleRecover=function(e){var t=this;e.preventDefault(),this.setState({isLoading:!0},function(){t.props.actions.auth.sendRecovery({email:t.state.email}).then(function(){t.setState({isLoading:!1}),t.props.actions.alert.success("Recovery email sent. Check your email.")}).catch(function(e){t.setState({isLoading:!1}),t.props.actions.alert.error(e.message)})})},t.prototype.updatePassword=function(e){var t=this;e.preventDefault(),this.setState({isLoading:!0},function(){var e=t.state,n=e.token,r=e.password,a=e.verificationPassword;t.props.actions.auth.updatePassword({token:n,password:r,verificationPassword:a}).then(function(){return t.props.actions.auth.login({email:t.props.tokens.token.user.email,password:r})}).then(function(){return t.props.dispatch(o.i(d.push)(t.state.redirectTo))}).catch(function(e){t.setState({isLoading:!1}),t.props.actions.alert.error(e.message)})})},t.prototype.handleChange=function(e){var t;this.setState((t={},t[e.target.name]=e.target.value,t))},t.prototype.renderStepOne=function(){return p.a.createElement(h.Segment,{stacked:!0,attached:"bottom"},p.a.createElement(h.Form.Field,{error:this.hasValidationError("email")},p.a.createElement("label",null,"Email"),p.a.createElement(h.Input,{icon:"mail",iconPosition:"left",name:"email",onChange:this.handleChange,placeholder:"Email",type:"text",value:this.state.email})),p.a.createElement(h.Button,{primary:!0,fluid:!0,disabled:this.state.isLoading,loading:this.state.isLoading,onClick:this.handleRecover,content:"Recover Password"}))},t.prototype.renderStepTwo=function(){return p.a.createElement(h.Segment,{stacked:!0},p.a.createElement(h.Form.Group,{widths:"equal"},p.a.createElement(h.Form.Field,{error:this.hasValidationError("password")},p.a.createElement("label",null,"New Password"),p.a.createElement(h.Input,{icon:"lock",iconPosition:"left",name:"password",onChange:this.handleChange,placeholder:"Password",type:"password",value:this.state.password})),p.a.createElement(h.Form.Field,{error:this.hasValidationError("verificationPassword")},p.a.createElement("label",null,"Confirm New Password"),p.a.createElement(h.Input,{name:"verificationPassword",onChange:this.handleChange,placeholder:"Re-enter new password",type:"password",value:this.state.verificationPassword}))),p.a.createElement(h.Button,{fluid:!0,primary:!0,disabled:this.state.isLoading,loading:this.state.isLoading,onClick:this.updatePassword,content:"Continue"}))},t.prototype.renderSteps=function(){return this.props.routeParams.token?this.renderStepTwo():this.renderStepOne()},t.prototype.render=function(){return p.a.createElement("div",null,p.a.createElement(h.Form,{autoComplete:"off"},this.renderSteps()),p.a.createElement(h.Message,{style:{textAlign:"center"}},"Already know your password? ",p.a.createElement(u.Link,{to:"/login"},"Log In")))},t}(p.a.Component),v.propTypes={auth:c.PropTypes.object.isRequired,dispatch:c.PropTypes.func.isRequired,actions:c.PropTypes.object.isRequired,location:c.PropTypes.object.isRequired,routeParams:c.PropTypes.object.isRequired,tokens:c.PropTypes.object.isRequired},g=P))||g}});
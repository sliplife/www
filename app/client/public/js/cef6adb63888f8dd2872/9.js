webpackJsonp([9],{1307:function(e,t,o){"use strict";function n(e,t){if(a)return localStorage.setItem(e,t)}function r(e){if(a)return localStorage.getItem(e)}function i(e){if(a)return localStorage.removeItem(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.setItem=n,t.getItem=r,t.removeItem=i;var a=!1;try{a="localStorage"in window;var s="tusSupport";localStorage.setItem(s,localStorage.getItem(s))}catch(e){if(e.code!==e.SECURITY_ERR&&e.code!==e.QUOTA_EXCEEDED_ERR)throw e;a=!1}t.canStoreURLs=a},1313:function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(74),s=o.n(a),l=o(0),u=o.n(l),c=o(51),p=o(185),h=(o.n(p),o(117)),d=o(62),f=o(73),y=(o.n(f),o(572)),v=o(1327),g=o.n(v);o.d(t,"default",function(){return S});var m,_,k,b,w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},E=function(e){return{auth:e.auth,error:e.listings.error}},x=function(e){return{dispatch:e,actions:{alert:o.i(h.a)(d.d,e),listings:o.i(h.a)(d.b,e),uploads:o.i(h.a)(d.f,e)}}},S=(m=o.i(c.connect)(E,x))((b=k=function(e){function t(o){n(this,t);var i=r(this,e.call(this,o));return i.state={isLoading:!0,listing:{amenities:[],city:"",description:"",location:"",uploads:[],state:"",type:""}},i.handleChange=i.handleChange.bind(i),i.handleContinue=i.handleContinue.bind(i),i.handleStateChange=i.handleStateChange.bind(i),i.handleAmenityChange=i.handleAmenityChange.bind(i),i.handleLocationChange=i.handleLocationChange.bind(i),i.handleTypeChange=i.handleTypeChange.bind(i),i.handleSelectPhotos=i.handleSelectPhotos.bind(i),i}return i(t,e),t.prototype.componentWillMount=function(){return this.props.auth.user?this.props.steps.listing.completed?this.props.dispatch(o.i(p.replace)("/submit/billing")):(this.setState({isLoading:!1}),void this.props.setActiveStep("listing")):this.props.dispatch(o.i(p.replace)("/submit"))},t.prototype.componentWillUnmount=function(){this.props.setActiveStep(!1)},t.prototype.componentDidMount=function(){this.handleSelectPhotosChanges(),y.a.done()},t.prototype.hasValidationError=function(e){return!(!s()(this.props.error,"validation.keys")||!this.props.error.validation.keys.includes(e))},t.prototype.handleContinue=function(e){var t=this;e.preventDefault(),this.setState({isLoading:!0},function(){var e=t.state.listing;t.props.actions.listings.create(w({},e)).then(function(e){t.props.setCompletedStep("listing"),t.props.dispatch(o.i(p.push)("/submit/billing"))}).catch(function(e){t.setState({isLoading:!1}),t.props.actions.alert.error(e.message)})})},t.prototype.handleChange=function(e){var t=this.state.listing;t[e.target.name]=e.target.value,this.setState({listing:t})},t.prototype.handleStateChange=function(e,t){this.setState({listing:w({},this.state.listing,{state:t.value})})},t.prototype.handleAmenityChange=function(e,t){this.setState({listing:w({},this.state.listing,{amenities:t.value})})},t.prototype.handleLocationChange=function(e,t){this.setState({listing:w({},this.state.listing,{location:t.value})})},t.prototype.handleTypeChange=function(e,t){this.setState({listing:w({},this.state.listing,{type:t.value})})},t.prototype.componentDidMount=function(){this.handleSelectPhotosChanges()},t.prototype.processFileUploads=function(){for(var e=this,t=this.fileInput.files,o=function(){if(r){if(i>=n.length)return"break";a=n[i++]}else{if(i=n.next(),i.done)return"break";a=i.value}var t=a,o=new g.a.Upload(t,{resume:!0,endpoint:"/api/uploads",headers:{},onError:function(t){e.setState({isLoading:!1},function(){return e.props.actions.alert.error(t)}),y.a.done()},onProgress:function(e,t){var o=(e/t*100).toFixed(2);y.a.set(o/100)},onSuccess:function(){var t=new RegExp(".*/uploads/(.*)$").exec(o.url)[1],n=e.state.listing.uploads;n.includes(t)||(n.push(t),e.setState({listing:w({},e.state.listing,{uploads:n})}))}});o.start()},n=t,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();;){var a;if("break"===o())break}},t.prototype.handleSelectPhotos=function(e){e.preventDefault(),this.fileInput.click()},t.prototype.handleSelectPhotosChanges=function(){var e=this;this.fileInput.addEventListener("change",function(t){return e.processFileUploads()})},t.prototype.render=function(){var e=this,t=[{key:"fl",value:"Florida",text:"Florida"}],o=[{key:"alcohol",value:"alcohol",text:"Alcohol"},{key:"anchorage",value:"anchorage",text:"Anchorage"},{key:"bait_tackle",value:"bait_tackle",text:"Bait & Tackle"},{key:"beach",value:"beach",text:"Beach"},{key:"bike_rentals",value:"bike_rentals",text:"Bike Rentals"},{key:"boat_ramp",value:"boat_ramp",text:"Boat Ramp"},{key:"cable_tv_hookup",value:"cable_tv_hookup",text:"Cable TV Hookup"},{key:"car_rentals",value:"car_rentals",text:"Car Rentals"},{key:"club_house",value:"club_house",text:"Club House"},{key:"covered_slips",value:"covered_slips",text:"Covered Slips"},{key:"deep_water",value:"deep_water",text:"Deep Water"},{key:"diesel",value:"diesel",text:"Diesel"},{key:"dinghy_dock",value:"dinghy_dock",text:"Dinghy Dock"},{key:"dockage",value:"dockage",text:"Dockage"},{key:"dog_park",value:"dog_park",text:"Dog Park"},{key:"dry_storage",value:"dry_storage",text:"Dry Storage"},{key:"electricity",value:"electricity",text:"Electricity"},{key:"engine_service",value:"engine_service",text:"Engine Service"},{key:"fitness_center",value:"fitness_center",text:"Fitness Center"},{key:"fixed_docks",value:"fixed_docks",text:"Fixed Docks"},{key:"floating_docks",value:"floating_docks",text:"Floating Docks"},{key:"fuel_dock",value:"fuel_dock",text:"Fuel Dock"},{key:"gas",value:"gas",text:"Gas"},{key:"golf",value:"golf",text:"Golf"},{key:"groceries",value:"groceries",text:"Groceries"},{key:"hotels",value:"hotels",text:"Hotels"},{key:"ice",value:"ice",text:"Ice"},{key:"internet",value:"internet",text:"Internet"},{key:"laundry",value:"laundry",text:"Laundry"},{key:"live_aboard_allowed",value:"live_aboard_allowed",text:"Live Aboard Allowed"},{key:"maintenance_facility",value:"maintenance_facility",text:"Maintenance Facility"},{key:"medical_facility",value:"medical_facility",text:"Medical Facility"},{key:"moorings",value:"moorings",text:"Moorings"},{key:"ocean_access",value:"ocean_access",text:"Ocean Access"},{key:"oil_disposal",value:"oil_disposal",text:"Oil Disposal"},{key:"pharmacy",value:"pharmacy",text:"Pharmacy"},{key:"pool",value:"pool",text:"Pool"},{key:"propane",value:"propane",text:"Propane"},{key:"propeller_service",value:"propeller_service",text:"Propeller Service"},{key:"pumpout",value:"pumpout",text:"Pump-out"},{key:"rack_storage",value:"rack_storage",text:"Rack Storage"},{key:"repair_crane",value:"repair_crane",text:"Repair Crane"},{key:"restaurants",value:"restaurants",text:"Restaurants"},{key:"restrooms",value:"restrooms",text:"Restrooms"},{key:"ship_store",value:"ship_store",text:"Ship Store"},{key:"showers",value:"showers",text:"Showers"},{key:"telephone_hookup",value:"telephone_hookup",text:"Telephone Hookup"},{key:"tennis",value:"tennis",text:"Tennis"},{key:"trash",value:"trash",text:"Trash"},{key:"trailer_storage",value:"trailer_storage",text:"Trailer Storage"},{key:"travel_lift",value:"travel_lift",text:"Travel Lift"},{key:"water_hookup",value:"water_hookup",text:"Water Hookup"},{key:"water_taxi",value:"water_taxi",text:"Water Taxi"},{key:"winter_storage",value:"winter_storage",text:"Winter Storage"},{key:"yacht_brokerage",value:"yacht_brokerage",text:"Yacht Brokerage"}],n=[{key:"dock",value:"dock",text:"Dock"},{key:"dry_storage",value:"dry_storage",text:"Dry Storage"},{key:"mooring",value:"mooring",text:"Mooring Buoy"},{key:"slip",value:"slip",text:"Slip"}],r=[{key:"condo",value:"condo",text:"Condo"},{key:"home",value:"home",text:"Home"},{key:"marina",value:"marina",text:"Marina"},{key:"vacant_lot",value:"vacant_lot",text:"Vacant Lot"}];return u.a.createElement("div",null,u.a.createElement(f.Segment,{as:f.Form,loading:this.state.isLoading},u.a.createElement("input",{multiple:!0,type:"file",style:{display:"none"},ref:function(t){e.fileInput=t}}),u.a.createElement(f.Form.Group,null,u.a.createElement(f.Form.Field,{error:this.hasValidationError("type"),width:"3"},u.a.createElement("label",null,"Location"),u.a.createElement(f.Dropdown,{fluid:!0,search:!0,selection:!0,placeholder:"Location",options:r,name:"location",onChange:this.handleLocationChange,value:this.state.listing.location})),u.a.createElement(f.Form.Field,{error:this.hasValidationError("type"),width:"3"},u.a.createElement("label",null,"Type"),u.a.createElement(f.Dropdown,{fluid:!0,search:!0,selection:!0,placeholder:"Type",options:n,name:"type",onChange:this.handleTypeChange,value:this.state.listing.type})),u.a.createElement(f.Form.Field,{error:this.hasValidationError("city"),width:"6"},u.a.createElement("label",null,"City"),u.a.createElement(f.Input,{name:"city",onChange:this.handleChange,placeholder:"City",type:"text",value:this.state.listing.city})),u.a.createElement(f.Form.Field,{error:this.hasValidationError("state"),width:"4"},u.a.createElement("label",null,"State"),u.a.createElement(f.Dropdown,{fluid:!0,search:!0,selection:!0,placeholder:"State",options:t,name:"state",onChange:this.handleStateChange,value:this.state.listing.state}))),u.a.createElement(f.Form.Field,{error:this.hasValidationError("amenities")},u.a.createElement("label",null,"Amenities"),u.a.createElement(f.Dropdown,{fluid:!0,search:!0,selection:!0,multiple:!0,placeholder:"Amenities",options:o,name:"state",onChange:this.handleAmenityChange,value:this.state.listing.amenities})),u.a.createElement(f.Form.Field,{error:this.hasValidationError("description")},u.a.createElement("label",null,"Description"),u.a.createElement(f.TextArea,{name:"description",onChange:this.handleChange,placeholder:"Description",type:"text",value:this.state.listing.description})),u.a.createElement(f.Divider,{horizontal:!0},u.a.createElement(f.Icon,{circular:!0,name:"photo",color:"blue"})),u.a.createElement(f.Button,{fluid:!0,content:"Select Photos ("+this.state.listing.uploads.length+")",onClick:this.handleSelectPhotos})),u.a.createElement(f.Segment,null,u.a.createElement(f.Button,{fluid:!0,primary:!0,disabled:this.state.isLoading,loading:this.state.isLoading,onClick:this.handleContinue,icon:"right arrow",labelPosition:"right",content:"Continue"})))},t}(u.a.Component),k.propTypes={dispatch:l.PropTypes.func,error:l.PropTypes.any,actions:l.PropTypes.object.isRequired,auth:l.PropTypes.object.isRequired,setActiveStep:l.PropTypes.func.isRequired,setCompletedStep:l.PropTypes.func.isRequired,steps:l.PropTypes.object.isRequired},_=b))||_},1314:function(e,t,o){"use strict";var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,i=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===r.call(e)},a=function(e){if(!e||"[object Object]"!==r.call(e))return!1;var t=n.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!o)return!1;var i;for(i in e);return void 0===i||n.call(e,i)};e.exports=function e(){var t,o,n,r,s,l,u=arguments[0],c=1,p=arguments.length,h=!1;for("boolean"==typeof u?(h=u,u=arguments[1]||{},c=2):("object"!=typeof u&&"function"!=typeof u||null==u)&&(u={});c<p;++c)if(null!=(t=arguments[c]))for(o in t)n=u[o],r=t[o],u!==r&&(h&&r&&(a(r)||(s=i(r)))?(s?(s=!1,l=n&&i(n)?n:[]):l=n&&a(n)?n:{},u[o]=e(h,l,r)):void 0!==r&&(u[o]=r));return u}},1321:function(e,t,o){var n,r;!function(i,a){n=a,void 0!==(r="function"==typeof n?n.call(t,o,t,e):n)&&(e.exports=r)}(0,function(){function e(){var e=arguments.length;if(0===e)throw new Error("resolveUrl requires at least one argument; got none.");var t=document.createElement("base");if(t.href=arguments[0],1===e)return t.href;var o=document.getElementsByTagName("head")[0];o.insertBefore(t,o.firstChild);for(var n,r=document.createElement("a"),i=1;i<e;i++)r.href=arguments[i],n=r.href,t.href=n;return o.removeChild(t),n}return e})},1322:function(e,t,o){"use strict";function n(e){return i(unescape(encodeURIComponent(e)))}Object.defineProperty(t,"__esModule",{value:!0}),t.encode=n;var r=window,i=r.btoa;t.isSupported="btoa"in window},1323:function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(){return new window.XMLHttpRequest}function i(e,t){return(0,s.default)(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.newRequest=r,t.resolveUrl=i;var a=o(1321),s=n(a)},1324:function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){if("function"==typeof e.slice&&void 0!==e.size)return new a(e);throw new Error("source object may only be an instance of File or Blob in this environment")}var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.getSource=r;var a=function(){function e(t){n(this,e),this._file=t,this.size=t.size}return i(e,[{key:"slice",value:function(e,t){return this._file.slice(e,t)}},{key:"close",value:function(){}}]),e}()},1325:function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(e){var o=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i=arguments.length<=2||void 0===arguments[2]?null:arguments[2];n(this,t);var a=r(this,Object.getPrototypeOf(t).call(this,e.message));a.originalRequest=i,a.causingError=o;var s=e.message;return null!=o&&(s+=", caused by "+o.toString()),null!=i&&(s+=", originated from request (response code: "+i.status+", response text: "+i.responseText+")"),a.message=s,a}return i(t,e),t}(Error);t.default=a},1326:function(e,t,o){"use strict";function n(e){return["tus",e.name,e.type,e.size,e.lastModified].join("-")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},1327:function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=o(1328),i=n(r),a=o(1307),s=i.default.defaultOptions;if("undefined"!=typeof window)var l=window,u=l.XMLHttpRequest,c=l.Blob,p=u&&c&&"function"==typeof c.prototype.slice;else var p=!0;e.exports={Upload:i.default,isSupported:p,canStoreURLs:a.canStoreURLs,defaultOptions:s}},1328:function(e,t,o){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){if(!g.isSupported)return"";var t=[];for(var o in e)t.push(o+" "+g.encode(e[o]));return t.join(",")}var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var l=o(1326),u=r(l),c=o(1325),p=r(c),h=o(1314),d=r(h),f=o(1323),y=o(1324),v=o(1322),g=n(v),m=o(1307),_=n(m),k={endpoint:"",fingerprint:u.default,resume:!0,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,headers:{},chunkSize:1/0,withCredentials:!1,uploadUrl:null,uploadSize:null,overridePatchMethod:!1,retryDelays:null},b=function(){function e(t,o){i(this,e),this.options=(0,d.default)(!0,{},k,o),this.file=t,this.url=null,this._xhr=null,this._fingerprint=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0}return s(e,[{key:"start",value:function(){var e=this,t=this.file;if(!t)return void this._emitError(new Error("tus: no file or stream to upload provided"));if(!this.options.endpoint)return void this._emitError(new Error("tus: no endpoint provided"));var o=this._source=(0,y.getSource)(t,this.options.chunkSize);if(null!=this.options.uploadSize){var n=+this.options.uploadSize;if(isNaN(n))throw new Error("tus: cannot convert `uploadSize` option into a number");this._size=n}else{var n=o.size;if(null==n)throw new Error("tus: cannot automatically derive upload's size from input and must be specified manually using the `uploadSize` option");this._size=n}var r=this.options.retryDelays;if(null!=r){if("[object Array]"!==Object.prototype.toString.call(r))throw new Error("tus: the `retryDelays` option must either be an array or null");!function(){var t=e.options.onError;e.options.onError=function(o){e.options.onError=t,null!=e._offset&&e._offset>e._offsetBeforeRetry&&(e._retryAttempt=0);var n=!0;if("undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(n=!1),!(e._retryAttempt<r.length&&null!=o.originalRequest&&n))return void e._emitError(o);var i=r[e._retryAttempt++];e._offsetBeforeRetry=e._offset,e.options.uploadUrl=e.url,e._retryTimeout=setTimeout(function(){e.start()},i)}}()}if(null!=this.options.uploadUrl)return this.url=this.options.uploadUrl,void this._resumeUpload();if(this.options.resume){this._fingerprint=this.options.fingerprint(t);var i=_.getItem(this._fingerprint);if(null!=i)return this.url=i,void this._resumeUpload()}this._createUpload()}},{key:"abort",value:function(){null!==this._xhr&&(this._xhr.abort(),this._source.close(),this._aborted=!0),null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null)}},{key:"_emitXhrError",value:function(e,t,o){this._emitError(new p.default(t,o,e))}},{key:"_emitError",value:function(e){if("function"!=typeof this.options.onError)throw e;this.options.onError(e)}},{key:"_emitSuccess",value:function(){"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"==typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,o){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,o)}},{key:"_setupXHR",value:function(e){e.setRequestHeader("Tus-Resumable","1.0.0");var t=this.options.headers;for(var o in t)e.setRequestHeader(o,t[o]);e.withCredentials=this.options.withCredentials}},{key:"_createUpload",value:function(){var e=this,t=(0,f.newRequest)();t.open("POST",this.options.endpoint,!0),t.onload=function(){if(!(t.status>=200&&t.status<300))return void e._emitXhrError(t,new Error("tus: unexpected response while creating upload"));e.url=(0,f.resolveUrl)(e.options.endpoint,t.getResponseHeader("Location")),e.options.resume&&_.setItem(e._fingerprint,e.url),e._offset=0,e._startUpload()},t.onerror=function(o){e._emitXhrError(t,new Error("tus: failed to create upload"),o)},this._setupXHR(t),t.setRequestHeader("Upload-Length",this._size);var o=a(this.options.metadata);""!==o&&t.setRequestHeader("Upload-Metadata",o),t.send(null)}},{key:"_resumeUpload",value:function(){var e=this,t=(0,f.newRequest)();t.open("HEAD",this.url,!0),t.onload=function(){if(!(t.status>=200&&t.status<300))return e.options.resume&&_.removeItem(e._fingerprint),e.url=null,void e._createUpload();var o=parseInt(t.getResponseHeader("Upload-Offset"),10);if(isNaN(o))return void e._emitXhrError(t,new Error("tus: invalid or missing offset value"));var n=parseInt(t.getResponseHeader("Upload-Length"),10);return isNaN(n)?void e._emitXhrError(t,new Error("tus: invalid or missing length value")):o===n?(e._emitProgress(n,n),void e._emitSuccess()):(e._offset=o,void e._startUpload())},t.onerror=function(o){e._emitXhrError(t,new Error("tus: failed to resume upload"),o)},this._setupXHR(t),t.send(null)}},{key:"_startUpload",value:function(){var e=this,t=this._xhr=(0,f.newRequest)();this.options.overridePatchMethod?(t.open("POST",this.url,!0),t.setRequestHeader("X-HTTP-Method-Override","PATCH")):t.open("PATCH",this.url,!0),t.onload=function(){if(!(t.status>=200&&t.status<300))return void e._emitXhrError(t,new Error("tus: unexpected response while uploading chunk"));var o=parseInt(t.getResponseHeader("Upload-Offset"),10);return isNaN(o)?void e._emitXhrError(t,new Error("tus: invalid or missing offset value")):(e._emitProgress(o,e._size),e._emitChunkComplete(o-e._offset,o,e._size),e._offset=o,o==e._size?(e._emitSuccess(),void e._source.close()):void e._startUpload())},t.onerror=function(o){e._aborted||e._emitXhrError(t,new Error("tus: failed to upload chunk at offset "+e._offset),o)},"upload"in t&&(t.upload.onprogress=function(t){t.lengthComputable&&e._emitProgress(o+t.loaded,e._size)}),this._setupXHR(t),t.setRequestHeader("Upload-Offset",this._offset),t.setRequestHeader("Content-Type","application/offset+octet-stream");var o=this._offset,n=this._offset+this.options.chunkSize;(n===1/0||n>this._size)&&(n=this._size),t.send(this._source.slice(o,n))}}]),e}();b.defaultOptions=k,t.default=b}});